server:
    # --- QUIET MODE ---
    # verbosity 0: Only log errors.
    # Essential to protect the Raspberry Pi's SD card from excessive writes.
    verbosity: 0

    # --- LISTENING INTERFACE ---
    # 0.0.0.0 means "Listen on all available network interfaces".
    interface: 0.0.0.0
    # We use port 5335 to avoid conflict with Pi-hole's standard port 53.
    # This acts as the "backdoor" communication channel.
    port: 5335

    # --- HOW IT WORKS ---
    # 1. Client asks Pi-hole (Port 53) for "google.com".
    # 2. Pi-hole checks blocklist. If safe, it forwards to Unbound (Port 5335).
    # 3. Unbound asks Root Servers directly, validates DNSSEC, and returns the IP.
    
    # Support for IPv4, UDP (speed), and TCP (reliability).
    do-ip4: yes
    do-udp: yes
    do-tcp: yes

    # --- ACCESS CONTROL (SECURITY) ---
    # Only allow queries from private local ranges (Docker, Home Network).
    # Deny everything else to prevent becoming an open resolver.
    access-control: 10.0.0.0/8 allow
    access-control: 172.16.0.0/12 allow
    access-control: 192.168.0.0/16 allow
    access-control: 127.0.0.0/8 allow

    # --- PRIVACY FEATURES ---
    # "QNAME Minimisation": Instead of sending the full query to every server,
    # we only send the minimum necessary part. Greatly increases privacy.
    qname-minimisation: yes
    
    # Hide identity: Do not report software version to prevent vulnerability scanning.
    hide-identity: yes
    hide-version: yes

    # --- CACHE PERFORMANCE ---
    # Prefetch: If a cached record is about to expire and is frequently requested,
    # refresh it automatically to keep response times near zero.
    prefetch: yes
    
    # Resource tuning for Raspberry Pi (Low memory footprint)
    num-threads: 1
    msg-cache-slabs: 2
    rrset-cache-slabs: 2
    infra-cache-slabs: 2
    key-cache-slabs: 2
    rrset-cache-size: 50m
    msg-cache-size: 25m